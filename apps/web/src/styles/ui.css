:root{
  --safe-top: env(safe-area-inset-top);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --glass: rgba(10, 12, 20, 0.55);
  --line: rgba(0,255,255,0.25);
  --text: rgba(220,255,255,0.95);
  --muted: rgba(160,220,220,0.75);
  --warn: rgba(255, 90, 90, 0.95);
  --ok: rgba(80, 255, 160, 0.95);
  --neon: rgba(0,255,255,0.9);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
*{
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #05060a;
  overflow: hidden;
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
#app { position: relative; height: 100%; width: 100%; }
#c { display: block; width: 100%; height: 100%; touch-action: none; }

#hud{
  position: absolute;
  top: calc(10px + var(--safe-top));
  left: calc(10px + var(--safe-left));
  right: calc(10px + var(--safe-right));
  display: grid;
  grid-template-columns: 1fr 1.2fr auto;
  gap: 10px;
  pointer-events: none;
}
#hud > div{
  background: var(--glass);
  border: 1px solid var(--line);
  border-radius: 14px;
  padding: 10px;
  backdrop-filter: blur(8px);
  box-shadow: 0 0 20px rgba(0,255,255,0.08);
  pointer-events: auto; /* buttons clickable */
}
#hud > .right{
  padding: 0;
  border: 0;
  background: transparent;
  box-shadow: none;
  backdrop-filter: none;
}
.row{ display:flex; justify-content:space-between; color: var(--text); font-weight: 700; letter-spacing: 0.5px; }
.k{ color: var(--muted); font-weight: 800; }
.status{
  font-weight: 900;
  letter-spacing: 1px;
  color: var(--neon);
  margin-bottom: 6px;
}

.telemetry-box{
  display: grid;
  gap: 8px;
  justify-items: center;
  color: var(--text);
}

.telemetry-grid{
  position: relative;
  width: 112px;
  height: 112px;
  border-radius: 16px;
  border: 1px solid var(--line);
  background:
    radial-gradient(circle at 50% 50%, rgba(0,255,255,0.06), rgba(0,0,0,0.1) 58%, rgba(0,0,0,0.24) 100%),
    linear-gradient(180deg, rgba(0,40,60,0.25), rgba(0,0,0,0.1));
  box-shadow: inset 0 0 20px rgba(0,255,255,0.08);
  overflow: hidden;
}

.telemetry-line{
  position: absolute;
  background: rgba(0,255,255,0.16);
}

.telemetry-line-h{
  left: 8px;
  right: 8px;
  top: 50%;
  height: 1px;
  transform: translateY(-50%);
}

.telemetry-line-v{
  top: 8px;
  bottom: 8px;
  left: 50%;
  width: 1px;
  transform: translateX(-50%);
}

.telemetry-ring{
  position: absolute;
  inset: 16px;
  border-radius: 50%;
  border: 1px solid rgba(0,255,255,0.14);
}

.telemetry-ball{
  position: absolute;
  left: 50%;
  top: 50%;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, #d6ffff 0%, #66ffff 35%, #00e6ff 70%, #0084b6 100%);
  border: 1px solid rgba(255,255,255,0.35);
  box-shadow: 0 0 10px rgba(0,255,255,0.9);
  transform: translate(-50%, -50%);
}

.telemetry-labels{
  width: 112px;
  display: flex;
  justify-content: space-between;
  color: var(--muted);
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.8px;
}

button{
  width: 100%;
  border: 1px solid var(--line);
  background: rgba(0,0,0,0.25);
  color: var(--text);
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 800;
  margin: 5px 0;
  touch-action: manipulation;
}
button:active{ transform: scale(0.98); }

.hint{
  margin-top: 6px;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.3;
  font-weight: 700;
}

.slider-group{
  margin: 8px 0 10px;
  padding: 8px 10px;
  border: 1px solid var(--line);
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.2);
}

.slider-row{
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  color: var(--text);
  font-size: 13px;
  font-weight: 800;
}

.slider-group input[type="range"]{
  width: 100%;
  accent-color: #00ffff;
  margin: 0;
}

.level-jump-group{
  margin: 8px 0 10px;
  padding: 8px 10px;
  border: 1px solid var(--line);
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.2);
}

.level-jump-row{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  align-items: center;
}

.level-jump-row input{
  width: 100%;
  min-width: 0;
  border: 1px solid var(--line);
  background: rgba(0,0,0,0.28);
  color: var(--text);
  border-radius: 10px;
  padding: 9px 10px;
  font-weight: 800;
  outline: none;
}

.level-jump-row input:focus{
  border-color: rgba(0,255,255,0.55);
  box-shadow: 0 0 0 2px rgba(0,255,255,0.12);
}

#btnGoLevel{
  width: auto;
  min-width: 72px;
  margin: 0;
}

.settings-menu{
  position: absolute;
  top: calc(10px + var(--safe-top));
  right: calc(10px + var(--safe-right));
  width: min(300px, calc(100vw - 20px - var(--safe-left) - var(--safe-right)));
  max-height: min(78vh, 560px);
  overflow: auto;
  z-index: 40;
  pointer-events: auto;
  background: rgba(8, 10, 18, 0.84);
  border: 1px solid var(--line);
  border-radius: 14px;
  padding: 12px;
  backdrop-filter: blur(10px);
  box-shadow: 0 0 24px rgba(0,255,255,0.16);
}

.settings-menu.hidden{
  display: none;
}

.menu-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.menu-title{
  color: var(--text);
  letter-spacing: 0.7px;
  font-weight: 900;
}

.menu-close{
  width: 40px;
  margin: 0;
  padding: 8px 0;
}

#btnMenu{
  width: auto;
  min-width: 110px;
  margin: 0;
}

.control-cluster.hidden{
  display: none;
}

#mobileControls{
  position: absolute;
  left: calc(12px + var(--safe-left));
  right: calc(12px + var(--safe-right));
  bottom: calc(12px + var(--safe-bottom));
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 14px;
  z-index: 28;
  pointer-events: none;
}

#mobileControls.swap-sides{
  flex-direction: row-reverse;
}

.control-cluster{
  pointer-events: auto;
  display: grid;
  gap: 8px;
  justify-items: center;
}

.control-label{
  color: rgba(215,255,255,0.85);
  font-weight: 900;
  letter-spacing: 1.1px;
  font-size: 11px;
  text-shadow: 0 0 10px rgba(0,255,255,0.2);
}

.joystick-pad{
  position: relative;
  width: 132px;
  height: 132px;
  border-radius: 50%;
  border: 1px solid rgba(0,255,255,0.22);
  background:
    radial-gradient(circle at 50% 48%, rgba(0,255,255,0.08), rgba(0,0,0,0.18) 58%, rgba(0,0,0,0.3) 100%),
    linear-gradient(180deg, rgba(12,20,34,0.78), rgba(7,10,16,0.78));
  box-shadow:
    inset 0 0 24px rgba(0,255,255,0.08),
    0 0 26px rgba(0,0,0,0.22);
  touch-action: none;
  user-select: none;
}

.joystick-grid,
.joystick-ring{
  position: absolute;
  inset: 0;
  border-radius: 50%;
  pointer-events: none;
}

.joystick-grid::before,
.joystick-grid::after{
  content: "";
  position: absolute;
  background: rgba(0,255,255,0.13);
}

.joystick-grid::before{
  left: 14px;
  right: 14px;
  top: 50%;
  height: 1px;
  transform: translateY(-50%);
}

.joystick-grid::after{
  top: 14px;
  bottom: 14px;
  left: 50%;
  width: 1px;
  transform: translateX(-50%);
}

.joystick-ring{
  inset: 14px;
  border: 1px solid rgba(0,255,255,0.15);
  box-shadow: inset 0 0 18px rgba(0,255,255,0.04);
}

.joystick-pad.active{
  box-shadow:
    inset 0 0 28px rgba(0,255,255,0.12),
    0 0 20px rgba(0,255,255,0.12),
    0 0 36px rgba(0,0,0,0.24);
}

.joystick-stick{
  position: absolute;
  left: 50%;
  top: 50%;
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,0.28);
  background:
    radial-gradient(circle at 35% 30%, rgba(220,255,255,0.96), rgba(85,255,255,0.76) 36%, rgba(0,190,255,0.48) 68%, rgba(0,80,120,0.55) 100%);
  box-shadow:
    inset 0 -4px 10px rgba(0,0,0,0.25),
    0 0 18px rgba(0,255,255,0.35);
  transform: translate(-50%, -50%);
  pointer-events: none;
}

.boost-cluster{
  justify-items: center;
}

.boost-btn{
  position: relative;
  width: 132px;
  height: 132px;
  margin: 0;
  padding: 0;
  border-radius: 50%;
  border: 1px solid rgba(255,170,80,0.32);
  background:
    radial-gradient(circle at 50% 68%, rgba(255,120,20,0.26), rgba(255,40,0,0.08) 52%, rgba(4,6,10,0.62) 100%),
    linear-gradient(180deg, rgba(25,14,12,0.86), rgba(9,10,14,0.86));
  box-shadow:
    inset 0 0 22px rgba(255,120,20,0.12),
    0 0 22px rgba(255,90,20,0.12),
    0 0 36px rgba(0,0,0,0.24);
  overflow: hidden;
  touch-action: none;
}

.boost-shell,
.boost-core{
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
}

.boost-shell{
  inset: 16px;
  background:
    radial-gradient(circle at 50% 68%, rgba(255,150,40,0.18), rgba(255,85,0,0.1) 44%, rgba(0,0,0,0) 72%),
    radial-gradient(circle at 50% 84%, rgba(255,180,70,0.12), rgba(0,0,0,0) 60%);
  border: 1px solid rgba(255,170,90,0.18);
}

.boost-core{
  inset: 30px;
  background:
    radial-gradient(circle at 50% 18%, rgba(190,255,255,0.95), rgba(120,235,255,0.82) 20%, rgba(120,235,255,0.08) 32%, rgba(0,0,0,0) 34%),
    radial-gradient(ellipse at 50% 62%, rgba(255,240,150,0.95), rgba(255,170,45,0.92) 28%, rgba(255,95,10,0.86) 54%, rgba(170,30,0,0.3) 76%, rgba(0,0,0,0) 84%);
  filter: saturate(1.2);
  opacity: 0.72;
  transform: translateY(2px) scale(0.96);
}

.boost-btn::before{
  content: "";
  position: absolute;
  inset: 8px;
  border-radius: 50%;
  border: 1px solid rgba(255,210,130,0.08);
  box-shadow: inset 0 0 14px rgba(255,160,70,0.06);
}

.boost-btn::after{
  content: "";
  position: absolute;
  left: 28px;
  right: 28px;
  bottom: 16px;
  height: 30px;
  border-radius: 50%;
  background: radial-gradient(ellipse at 50% 50%, rgba(255,120,20,0.28), rgba(255,80,0,0.06) 70%, rgba(0,0,0,0) 100%);
  opacity: 0.4;
  pointer-events: none;
}

.boost-text{
  position: absolute;
  inset: auto 0 14px 0;
  text-align: center;
  color: rgba(255,244,230,0.94);
  font-weight: 900;
  letter-spacing: 1.2px;
  font-size: 13px;
  text-shadow:
    0 0 10px rgba(255,145,35,0.45),
    0 0 4px rgba(0,0,0,0.65);
  pointer-events: none;
}

.boost-btn.active{
  border-color: rgba(255,184,92,0.56);
  box-shadow:
    inset 0 0 28px rgba(255,135,20,0.18),
    0 0 28px rgba(255,120,20,0.28),
    0 0 56px rgba(255,90,20,0.16);
}

.boost-btn.active .boost-core{
  opacity: 0.98;
  animation: boostFlameFlicker 90ms linear infinite alternate;
}

.boost-btn.active .boost-shell{
  animation: boostHaloPulse 220ms ease-in-out infinite alternate;
}

.boost-btn.active .boost-text{
  color: rgba(255,250,240,1);
  text-shadow:
    0 0 14px rgba(255,180,70,0.8),
    0 0 24px rgba(255,100,20,0.35);
}

@keyframes boostFlameFlicker{
  from{ transform: translateY(1px) scale(0.97); filter: saturate(1.15) brightness(1.0); }
  to{ transform: translateY(-1px) scale(1.02); filter: saturate(1.3) brightness(1.15); }
}

@keyframes boostHaloPulse{
  from{ opacity: 0.72; transform: scale(0.99); }
  to{ opacity: 0.95; transform: scale(1.02); }
}

/* Rotation-friendly: in landscape, compress HUD */
@media (orientation: landscape){
  #hud{ grid-template-columns: 1fr 1fr 1fr; }
  #mobileControls{
    left: calc(10px + var(--safe-left));
    right: calc(10px + var(--safe-right));
    bottom: calc(10px + var(--safe-bottom));
  }
  .joystick-pad,
  .boost-btn{ width: 118px; height: 118px; }
  .joystick-stick{ width: 38px; height: 38px; }
}
